import unittest
import unittest.mock
from tool.feature_extraction.writers.dict_to_dataframe import (
    DictToDataFrameWriter
)
import numpy as np
import pandas as pd

class TestDictToDataFrameWriter(unittest.TestCase):
    def setUp(self):
        self.file = "myfile"
        self.input = {"a": 12, "w": 13}

    def test_write(self):
        with unittest.mock.patch("pandas.DataFrame", set_spec=True) as m:
            m.return_value = m
            instance = DictToDataFrameWriter(self.file)
            instance.process(self.input)
            m.assert_called_once_with([self.input])
            args, kwargs = m.to_csv.call_args_list[0]
            self.assertEqual(
                kwargs,
                {"index": False, "header": not instance.header, "mode": "a"}
            )
            self.assertEqual(args[-1], self.file)
