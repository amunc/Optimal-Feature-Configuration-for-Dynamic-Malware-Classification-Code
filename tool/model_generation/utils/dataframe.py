# -*- coding: utf-8 -*-
"""
Created on Fri Jul 10 08:55:50 2020

@author: David
"""
from typing import Any, Container, Tuple, Union
import pandas as pd
import numpy as np


def split_dataframe_by_columns(
        df: pd.DataFrame,
        to_split: Union[str, Container[Any]]
        ) -> Tuple[pd.DataFrame, pd.DataFrame]:
    '''
    Splits a pandas.Dataframe in two new dataframes: one with all the original
    columns except those in to_split and the other with the columns in to_split

    Arguments
    ---------
    df: pd.DataFrame
        The dataframe to split
    to_split: Union[str, Container[Any]]
        The column or columns to extract from the dataframe

    Return
    ------
    Tuple[pd.DataFrame, pd.DataFrame]
        A tuple of two dataframes, one with all the original columns except
        those in to_split and the other with the columns in to_split
    '''
    if isinstance(to_split, str):
        rest = [col for col in df.columns if col != to_split]
    else:
        rest = [col for col in df.columns if col not in to_split]
    return df[rest], df[to_split]


def split_dataframe_by_columns_to_numpy(
        df: pd.DataFrame, to_split: Union[str, Container[Any]]
        ) -> Tuple[np.ndarray, np.ndarray]:
    '''
    Like split_dataframe_by_columns, except it returns two numpy.ndarray
    instead if pandas.Dataframe

    Arguments
    ---------
    Arguments
    ---------
    df: pd.DataFrame
        The dataframe to split
    to_split: Union[str, Container[Any]]
        The column or columns to extract from the dataframe

    Return
    ------
    Tuple[np.ndarray, np.ndarray]
    '''
    one, other = split_dataframe_by_columns(df, to_split)
    return one.values, other.values
