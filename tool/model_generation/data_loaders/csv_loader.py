# -*- coding: utf-8 -*-
"""
Created on Fri Jul 10 08:42:41 2020

@author: David
"""
import pandas as pd
from ..utils.dataframe import split_dataframe_by_columns_to_numpy


class CSVLoader:
    '''
    Class to wrap loading of a Dataframe
    '''
    def __init__(self, *pandas_args, **pandas_kwargs):
        self.pandas_args = pandas_args
        self.pandas_kwargs = pandas_kwargs

    def load(self, file):
        return pd.read_csv(file, *self.pandas_args, **self.pandas_kwargs)


class CSVSplitLoader(CSVLoader):
    def __init__(self, *pandas_args, target_column=None,
                 columns_to_discard=[], **pandas_kwargs):
        CSVLoader.__init__(self, *pandas_args, **pandas_kwargs)
        self.target_column = target_column
        self.columns_to_discard = columns_to_discard

    def load(self, file):
        df = CSVLoader.load(self, file)
        df.drop(self.columns_to_discard, axis=1, inplace=True)
        target_col = self.target_column or df.columns[-1]
        return split_dataframe_by_columns_to_numpy(df, target_col)
