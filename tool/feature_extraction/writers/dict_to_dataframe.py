# -*- coding: utf-8 -*-
"""
Created on Mon Jul  6 11:14:48 2020

@author: David
"""

import pandas as pd
from ..processor import BaseProcessor

class DictToDataFrameWriter(BaseProcessor):
    def __init__(self, file):
        self.file = file
        self.header = True

    def process(self, features):
        return self.write(features)

    def write(self, features):
        pd.DataFrame([features]).to_csv(self.file, index=False,
                                        header=self.header, mode='a')
        self.header = not self.header if self.header else self.header
