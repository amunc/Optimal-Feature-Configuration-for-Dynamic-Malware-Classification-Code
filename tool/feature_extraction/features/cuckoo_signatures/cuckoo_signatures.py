# -*- coding: utf-8 -*-
"""
Created on Tue Jun 25 10:59:17 2019

@author: David
"""


def new_signatures():
    return set(['android_antivirus_virustotal', 'android_dangerous_permissions', 'android_dynamic_code', 'android_embedded_apk', 'android_google_play_diff', 'android_native_code', 'android_reflection_code', 'application_aborted_broadcast_receiver', 'application_deleted_app', 'application_executed_shell_command', 'application_installed_app', 'application_queried_account_info', 'application_queried_installed_apps', 'application_queried_phone_number', 'application_queried_private_information', 'application_recording_audio', 'application_registered_receiver_runtime', 'application_sent_sms_messages', 'application_stopped_processes', 'application_uses_location', 'application_using_the_camera', 'dumped_buffer2', 'dumped_buffer', 'html_flash', 'js_eval', 'js_iframe', 'js_suspicious', 'js_anti_analysis', 'encryption_keys', 'pdf_javascript', 'pdf_attachments', 'pdf_openaction', 'pdf_openaction_js', 'darwin_code_injection', 'task_for_pid', 'dead_host', 'network_dns_txt_lookup', 'suspicious_tld', 'network_bind', 'network_http_post', 'network_cnc_http', 'networkdyndns_checkip', 'network_http', 'network_icmp', 'network_irc', 'network_smtp', 'network_torgateway', 'network_wscript_downloader', 'nolookup_communication', 'p2p_cnc', 'snort_alert', 'suricata_alert', 'allocates_rwx', 'allocates_execute_remote_process', 'antianalysis_detectfile', 'antiav_avast_libs', 'antiav_bitdefender_libs', 'antiav_detectfile', 'antiav_detectreg', 'antiav_servicestop', 'antiav_srp', 'checks_debugger', 'checks_kernel_debugger', 'antidbg_devices', 'antidbg_windows', 'antiemu_wine', 'antisandbox_clipboard', 'antisandbox_cuckoo_files', 'antisandbox_file', 'antisandbox_foregroundwindows', 'antisandbox_fortinet_files', 'antisandbox_idletime', 'antisandbox_joe_anubis_files', 'antisandbox_mouse_hook', 'antisandbox_restart', 'antisandbox_sleep', 'antisandbox_sunbelt_files', 'antisandbox_sunbelt', 'antisandbox_threattrack_files', 'antisandbox_unhook', 'av_detect_china_key', 'antivirus_irma', 'antivirus_virustotal', 'antivm_xen_keys', 'antivm_queries_computername', 'antivm_disk_size', 'antivm_generic_bios', 'antivm_generic_cpu', 'antivm_generic_disk', 'antivm_firmware', 'antivm_generic_ide', 'antivm_generic_scsi', 'antivm_generic_services', 'antivm_hyperv_keys', 'antivm_memory_available', 'antivm_network_adapters', 'antivm_parallels_keys', 'antivm_parallels_window', 'antivm_shared_device', 'antivm_sandboxie', 'antivm_vbox_acpi', 'antivm_vbox_devices', 'antivm_vbox_files', 'antivm_vbox_keys', 'antivm_vbox_provname', 'antivm_vbox_window', 'antivm_virtualpc_illegal_instruction', 'antivm_virtualpc', 'antivm_virtualpc_window', 'antivm_vmware_files', 'antivm_vmware_in_instruction', 'antivm_vmware_keys', 'antivm_vmware_window', 'antivm_vpc_keys', 'antivm_xen_keys', 'installs_appinit', 'applocker_bypass', 'apt_carbunak', 'apt_cloudatlas', 'targeted_flame', 'apt_inception', 'putterpanda_mutexes', 'apt_sandworm_ip', 'apt_sandworm_url', 'apt_turlacarbon', 'uroburos_file', 'uroburos_mutexes', 'rat_lolbot', 'rat_sdbot', 'backdoor_tdss', 'backdoor_vanbot', 'backdoor_whimoo', 'bad_certificate', 'banker_bancos', 'banker_cridex', 'banker_prinimalka', 'banker_spyeye_mutexes', 'banker_spyeye_url', 'banker_tinba_mutexes', 'banker_zeus_mutex', 'banker_zeus_p2p', 'banker_zeus_url', 'banking_mutexes', 'bitcoin_opencl', 'modifies_boot_config', 'bootkit', 'bot_athenahttp', 'athena_url', 'betabot_url', 'bot_dirtjumper', 'bot_drive2', 'bot_drive', 'bot_kelihos', 'bot_kovter', 'bot_madness', 'ponybot_url', 'bot_russkill', 'solarbot_url', 'bot_vnloader_url', 'warbot_url', 'installs_bho', 'browser_security', 'browser_startpage', 'bypass_firewall', 'carberp_mutex', 'clears_event_logs', 'clear_permission_event_logs', 'clickfraud_cookies', 'cloud_dropbox', 'Cloudflare', 'cloud_google', 'cloud_mediafire', 'cloud_mega', 'cloud_rapidshare', 'cloud_wetransfer', 'creates_doc', 'creates_exe', 'creates_user_folder_exe', 'creates_hidden_file', 'creates_largekey', 'creates_null_reg_entry', 'creates_service', 'creates_shortcut', 'credential_dumping_lsass', 'credential_dumping_lsass_access', 'generates_crypto_key', 'cryptomining_stratum_command', 'office_dde', 'ddos_blackrev_mutexes', 'ddos_darkddos_mutexes', 'ddos_eclipse_mutexes', 'ddos_ipkiller_mutexes', 'deepfreeze_mutex', 'deletes_executed_files', 'detect_putty', 'mutex_winscp', 'disables_app_launch', 'disables_browser_warn', 'disables_security', 'disables_system_restore', 'disables_wer', 'disables_windowsupdate', 'dnsserver_dynamic', 'exp_3322_dom', 'dns_freehosting_domain', 'downloader_cabby', 'dridex_behavior', 'shutdown_system', 'dropper', 'exe_appdata', 'emotet_behavior', 'removes_zoneid_ads', 'excel_datalink', 'exec_bits_admin', 'exec_crash', 'exec_waitfor', 'exploit_heapspray', 'stack_pivot', 'dep_heap_bypass', 'dep_stack_bypass', 'shellcode_writeprocessmemory', 'stack_pivot_shellcode_apis', 'stackpivot_shellcode_createprocess', 'exploit_blackhole_url', 'exploitkit_mutexes', 'sweetorange_mutexes', 'fraudtool_fakerean', 'generic_metrics', 'pwdump_file', 'has_authenticode', 'has_pdb', 'im_btb', 'im_qq', 'infostealer_bitcoin', 'disables_spdy_firefox', 'disables_spdy_ie', 'disables_spdy_chrome', 'modifies_firefox_configuration', 'disables_ie_http2', 'infostealer_browser', 'infostealer_clipboard', 'infostealer_derusbi_files', 'infostealer_ftp', 'infostealer_im', 'infostealer_keylogger', 'infostealer_mail', 'injection_explorer', 'injection_modifies_memory', 'injection_network_trafic', 'injection_runpe', 'injection_createremotethread', 'injection_queueapcthread', 'injection_resumethread', 'injection_ntsetcontextthread', 'injection_write_memory', 'injection_write_memory_exe', 'javascript_commandline', 'ardamax_mutexes', 'jintor_mutexes', 'locates_browser', 'locates_sniffer', 'locker_cmd', 'locker_regedit', 'locker_taskmgr', 'malicious_document_urls', 'process_martian', 'martian_command_process', 'memdump_urls', 'memdump_tor_urls', 'memdump_ip_urls', 'memdump_yara', 'miningpool', 'modifies_certificates', 'modifies_proxy_wpad', 'modifies_proxy_override', 'modifies_proxy_autoconfig', 'disables_proxy', 'modifies_security_center_warnings', 'modify_uac_prompt', 'modifies_desktop_wallpaper', 'modifies_zoneid', 'moves_self', 'multiple_useragents', 'rdp_mutexes', 'mirc_file', 'network_tor', 'network_tor_service', 'urlshortcn_checkip', 'vnc_mutexes', 'nymaim_behavior', 'office_packager', 'office_create_object', 'office_check_project_name', 'office_count_dirs', 'office_appinfo_version', 'office_check_window', 'office_http_request', 'office_recent_files', 'has_office_eps', 'office_indirect_call', 'office_check_doc_name', 'office_platform_detect', 'document_close', 'document_open', 'office_eps_strings', 'office_vuln_guid', 'office_vuln_modules', 'rtf_unknown_version', 'rtf_unknown_character_set', 'origin_langid', 'packer_entropy', 'packer_polymorphic', 'packer_upx', 'packer_vmprotect', 'network_document_file', 'network_downloader_exe', 'suspicious_write_exe', 'pe_features', 'peid_packer', 'pe_unknown_resource_name', 'persistence_ads', 'persistence_autorun', 'persistence_bootexecute', 'persistence_registry_javascript', 'persistence_registry_exe', 'persistence_registry_powershell', 'alina_pos_file', 'alina_pos_url', 'blackpos_url', 'decebal_mutexes', 'dexter', 'jackpos_file', 'jackpos_url', 'pos_poscardstealer_url', 'powerfun', 'suspicious_powershell', 'amsi_bypass', 'powershell_bitstransfer', 'powershell_ddi_rc4', 'powershell_dfsp', 'powershell_di', 'powershell_download', 'powershell_empire', 'powershell_meterpreter', 'powershell_request', 'powershell_c2dns', 'powershell_unicorn', 'powershell_reg_add', 'powerworm', 'privilege_luid_check', 'process_interest', 'injection_process_search', 'process_needed', 'protection_rx', 'raises_exception', 'applcation_raises_exception', 'chanitor_mutexes', 'ransomware_bcdedit', 'ransomware_extensions', 'ransomware_file_moves', 'ransomware_appends_extensions', 'ransomware_dropped_files', 'ransomware_mass_file_delete', 'ransomware_files', 'ransomware_message', 'ransomware_message_ocr', 'ransomware_recyclebin', 'ransomware_shadowcopy', 'ransomware_viruscoder', 'ransomware_wbadmin', 'rat_adzok', 'bandook', 'rat_beastdoor', 'rat_beebus_mutexes', 'rat_bifrose', 'rat_blackhole', 'rat_blackice', 'rat_blackshades', 'bladabindi_mutexes', 'rat_bottilda', 'bozok_key', 'rat_buzus_mutexes', 'rat_comRAT', 'cybergate', 'darkcloud', 'rat_darkshell', 'rat_delf', 'rat_dibik', 'evilbot', 'farfli', 'rat_fexel_ip', 'rat_flystudio', 'rat_fynloski', 'ghostbot', 'hesperbot', 'rat_hikit', 'rat_hupigon', 'icepoint', 'rat_jewdo', 'trojan_jorik', 'karakum', 'rat_koutodoor', 'kuluoz_mutexes', 'rat_likseput', 'rat_madness', 'madness_url', 'magania_mutexes', 'minerbot', 'rat_mybot', 'rat_naid_ip', 'nakbot', 'rat_netobserve', 'netshadow', 'netwire', 'nitol', 'njrat', 'rat_pasta', 'rat_pcclient', 'rat_plugx', 'poebot', 'poisonivy', 'qakbot', 'rat_rbot', 'renostrojan', 'sadbot', 'senna', 'rat_shadowbot', 'rat_siggenflystudio', 'rat_spynet', 'spyrecorder', 'staser', 'rat_swrort', 'rat_teamviewer', 'rat_travnet', 'rat_trogbot', 'rat_turkojan', 'urlspy', 'rat_urxbot', 'rat_vertex', 'vertex_url', 'wakbot', 'rat_xtreme', 'rat_zegost', 'reads_user_agent', 'recon_beacon', 'recon_checkip', 'recon_fingerprint', 'recon_programs', 'queries_programs', 'recon_systeminfo', 'blackenergy_mutexes', 'self_delete_bat', 'sharing_rghost', 'metasploit_shellcode', 'SipStun', 'smtp_gmail', 'smtp_live', 'smtp_mail_ru', 'smtp_yahoo', 'sniffer_winpcap', 'spreading_autoruninf', 'stealth_childproc', 'stealth_hidden_extension', 'stealth_hiddenfile', 'stealth_hidden_icons', 'stealth_hide_notifications', 'stealth_system_procname', 'stealth_window', 'stops_service', 'suspicious_process', 'TAPI_DP_mutex', 'terminates_remote_process', 'trojan_bublik', 'trojan_ceatrg', 'coinminer_mutexes', 'trojan_dapato', 'begseabugtd_mutexes', 'upatretd_mutexes', 'trojan_emotet', 'trojan_jorik', 'trojan_kilim', 'trojan_lethic', 'trojan_lockscreen', 'trojan_mrblack', 'obfus_mutexes', 'trojan_pincav', 'trojan_redosru', 'rovnix', 'trojan_sysn', 'tnega_mutexes', 'trojan_vbinject', 'trojan_yoddos', 'url_file', 'andromeda', 'bagle', 'banload', 'btc', 'c24_url', 'cryptlocker', 'ddos556', 'decay', 'dofoil', 'dyreza', 'expiro', 'fakeav_mutexes', 'fakeav_mutexes', 'gaelicum', 'infinity', 'ircbrute', 'isrstealer_url', 'istealer_url', 'karagany', 'katusha', 'killdisk', 'koobface', 'luder', 'vir_napolar', 'vir_nebuler', 'oldrea', 'perflogger', 'pidief', 'ponfoy', 'vir_pykse', 'ragebot', 'ramnit', 'sharpstealer_url', 'shiza', 'shylock', 'UFR_Stealer', 'upatre', 'jeefo_mutexes', 'tufik_mutexes', 'virut', 'volatility_malfind_2', 'volatility_ldrmodules_1', 'volatility_ldrmodules_2', 'volatility_devicetree_1', 'volatility_svcscan_1', 'volatility_svcscan_2', 'volatility_svcscan_3', 'volatility_modscan_1', 'volatility_handles_1', 'console_output', 'uses_windows_utilities', 'suspicious_command_tools', 'sysinternals_tools_usage', 'adds_user', 'adds_user_admin', 'has_wmi', 'win32_process_create', 'wmi_antivm', 'wmi_persistance', 'wmi_service', 'worm_allaple', 'fesber_mutexes', 'worm_kolabc', 'krepper_mutexes', 'worm_palevo', 'worm_phorpiex', 'worm_psyokym', 'puce_mutexes', 'worm_renocide', 'worm_rungbu', 'runouce_mutexes', 'winsxsbot', 'worm_xworm'])


def signature_names_current():
    return set(['Locky_behavior',
        'Neutrino_js',
        'TrickBotTaskDelete',
        'alphacrypt_behavior',
        'android_AirPush_Adware',
        'android_Umeng_Adware',
        'android_antivirus_virustotal',
        'android_antivirus_virustotal_threshold',
        'android_dangerous_permissions',
        'android_dynamic_code',
        'android_google_play_diff',
        'android_hidden_payload',
        'android_maware_androrat',
        'android_maware_iBanking',
        'android_maware_snadrorat',
        'android_native_code',
        'android_packer',
        'android_reflection_code',
        'andromeda_behavior',
        'angler_js',
        'antianalysis_detectfile',
        'antianalysis_detectreg',
        'antiav_avast_libs',
        'antiav_bitdefender_libs',
        'antiav_detectfile',
        'antiav_detectreg',
        'antiav_servicestop',
        'antiav_srp',
        'antidbg_devices',
        'antidbg_windows',
        'antiemu_wine_func',
        'antiemu_wine_reg',
        'antisandbox_cuckoo',
        'antisandbox_cuckoo_files',
        'antisandbox_cuckoocrash',
        'antisandbox_fortinet_files',
        'antisandbox_joe_anubis_files',
        'antisandbox_mouse_hook',
        'antisandbox_sboxie_libs',
        'antisandbox_sboxie_mutex',
        'antisandbox_sboxie_objects',
        'antisandbox_script_timer',
        'antisandbox_sleep',
        'antisandbox_sunbelt_files',
        'antisandbox_sunbelt_libs',
        'antisandbox_suspend',
        'antisandbox_threattrack_files',
        'antisandbox_unhook',
        'antivirus_virustotal',
        'antivm_directory_objects',
        'antivm_generic_bios',
        'antivm_generic_cpu',
        'antivm_generic_disk',
        'antivm_generic_diskreg',
        'antivm_generic_scsi',
        'antivm_generic_services',
        'antivm_generic_system',
        'antivm_hyperv_keys',
        'antivm_parallels_keys',
        'antivm_vbox_devices',
        'antivm_vbox_files',
        'antivm_vbox_keys',
        'antivm_vbox_libs',
        'antivm_vbox_window',
        'antivm_vmware_devices',
        'antivm_vmware_events',
        'antivm_vmware_files',
        'antivm_vmware_keys',
        'antivm_vmware_libs',
        'antivm_vmware_mutexes',
        'antivm_vpc_files',
        'antivm_vpc_keys',
        'antivm_vpc_mutex',
        'antivm_xen_keys',
        'api_spamming',
        'application_aborted_broadcast_receiver',
        'application_contains_apk',
        'application_contains_arm_binaries',
        'application_contains_dex',
        'application_contains_jar',
        'application_contains_so',
        'application_device_admin',
        'application_dropped_dex',
        'application_dropped_files',
        'application_dropped_so',
        'application_executed_shell_command',
        'application_fingerprint',
        'application_installed_app',
        'application_queried_account_info',
        'application_queried_installed_apps',
        'application_queried_private_information',
        'application_recording_audio',
        'application_reflection',
        'application_registered_receiver_runtime',
        'application_root',
        'application_sent_sms_messages',
        'application_setComponentEnabledSetting',
        'application_stopped_processes',
        'application_uses_location',
        'application_using_the_camera',
        'bad_certs',
        'bad_ssl_certs',
        'banker_cridex',
        'banker_prinimalka',
        'banker_spyeye_mutexes',
        'banker_zeus_mutex',
        'banker_zeus_p2p',
        'banker_zeus_url',
        'bcdedit_command',
        'betabot_behavior',
        'bitcoin_opencl',
        'bootkit',
        'bot_athenahttp',
        'bot_dirtjumper',
        'bot_drive',
        'bot_drive2',
        'bot_kraken_mutexes',
        'bot_madness',
        'bot_russkill',
        'browser_addon',
        'browser_helper_object',
        'browser_needed',
        'browser_scanbox',
        'browser_security',
        'browser_startpage',
        'bypass_firewall',
        'carberp_mutex',
        'cerber_behavior',
        'chimera_behavior',
        'clamav',
        'clickfraud_cookies',
        'codelux_behavior',
        'copies_self',
        'creates_largekey',
        'creates_nullvalue',
        'critical_process',
        'cryptowall_behavior',
        'cve_2014_6332',
        'cve_2015_2419_js',
        'cve_2016-0189',
        'cve_2016_7200',
        'darkcomet_regkeys',
        'dead_connect',
        'dead_link',
        'debugs_self',
        'decoy_document',
        'deepfreeze_mutex',
        'deletes_self',
        'deletes_shadow_copies',
        'dep_bypass',
        'dep_disable',
        'disables_app_launch',
        'disables_browser_warn',
        'disables_spdy',
        'disables_system_restore',
        'disables_uac',
        'disables_wer',
        'disables_wfp',
        'disables_windows_defender',
        'disables_windowsupdate',
        'downloader_cabby',
        'dridex_behavior',
        'driver_load',
        'dropper',
        'dyre_behavior',
        'encrypted_ioc',
        'exec_crash',
        'family_proxyback',
        'fleercivet_mutex',
        'generic_phish',
        'geodo_banking_trojan',
        'gondad_js',
        'gootkit_behavior',
        'h1n1_behavior',
        'hancitor_behavior',
        'hawkeye_behavior',
        'heapspray_js',
        'ie_martian_children',
        'infostealer_bitcoin',
        'infostealer_browser',
        'infostealer_browser_password',
        'infostealer_ftp',
        'infostealer_im',
        'infostealer_keylog',
        'infostealer_mail',
        'injection_createremotethread',
        'injection_explorer',
        'injection_needextension',
        'injection_runpe',
        'injection_rwx',
        'internet_dropper',
        'ipc_namedpipe',
        'ispy_behavior',
        'java_js',
        'js_phish',
        'js_suspicious_redirect',
        'kazybot_behavior',
        'kelihos_behavior',
        'kibex_behavior',
        'kovter_behavior',
        'locker_regedit',
        'locker_taskmgr',
        'mimics_agent',
        'mimics_extension',
        'mimics_filetime',
        'mimics_icon',
        'modifies_certs',
        'modifies_desktop_wallpaper',
        'modifies_hostfile',
        'modify_proxy',
        'modify_security_center_warnings',
        'modify_uac_prompt',
        'multiple_useragents',
        'network_anomaly',
        'network_bind',
        'network_cnc_http',
        'network_dga',
        'network_document_http',
        'network_excessive_udp',
        'network_http',
        'network_icmp',
        'network_irc',
        'network_smtp',
        'network_tor',
        'network_tor_service',
        'network_torgateway',
        'nuclear_js',
        'nymaim_behavior',
        'office_code_page',
        'office_macro',
        'office_martian_children',
        'office_security',
        'office_write_exe',
        'origin_langid',
        'origin_resource_langid',
        'packer_armadillo_mutex',
        'packer_armadillo_regkey',
        'packer_confuser',
        'packer_entropy',
        'packer_smartassembly',
        'packer_themida',
        'packer_upx',
        'packer_vmprotect',
        'pdf_annot_urls',
        'persistence_ads',
        'persistence_autorun',
        'persistence_bootexecute',
        'persistence_service',
        'polymorphic',
        'pony_behavior',
        'powershell_command',
        'prevents_safeboot',
        'process_interest',
        'process_needed',
        'procmem_yara',
        'punch_plus_plus_pcres',
        'ransomware_dmalocker',
        'ransomware_extensions',
        'ransomware_file_modifications',
        'ransomware_files',
        'ransomware_message',
        'ransomware_radamant',
        'ransomware_recyclebin',
        'rat_beebus_mutexes',
        'rat_fynloski_mutexes',
        'rat_luminosity',
        'rat_nanocore',
        'rat_pcclient',
        'rat_plugx_mutexes',
        'rat_poisonivy_mutexes',
        'rat_quasar_mutexes',
        'rat_spynet',
        'rat_xtreme_mutexes',
        'reads_self',
        'recon_beacon',
        'recon_checkip',
        'recon_fingerprint',
        'recon_programs',
        'recon_systeminfo',
        'removes_zoneid_ads',
        'rig_js',
        'secure_login_phish',
        'securityxploded_modules',
        'sets_autoconfig_url',
        'shifu_behavior',
        'silverlight_js',
        'sniffer_winpcap',
        'spoofs_procname',
        'spreading_autoruninf',
        'stack_pivot',
        'static_authenticode',
        'static_dotnet_anomaly',
        'static_java',
        'static_pdf',
        'static_pe_anomaly',
        'static_rat_config',
        'static_versioninfo_anomaly',
        'stealth_childproc',
        'stealth_file',
        'stealth_hidden_extension',
        'stealth_hiddenreg',
        'stealth_hide_notifications',
        'stealth_network',
        'stealth_timeout',
        'stealth_webhistory',
        'stealth_window',
        'sundown_js',
        'suricata_alert',
        'targeted_flame',
        'tinba_behavior',
        'trickbot_mutex',
        'troldesh_behavior',
        'upatre_behavior',
        'ursnif_behavior',
        'user_enum',
        'vawtrak_behavior',
        'virtualcheck_js',
        'virus',
        'volatility_devicetree_1',
        'volatility_handles_1',
        'volatility_ldrmodules_1',
        'volatility_ldrmodules_2',
        'volatility_malfind_1',
        'volatility_malfind_2',
        'volatility_modscan_1',
        'volatility_svcscan_1',
        'volatility_svcscan_2',
        'volatility_svcscan_3',
        'webmail_phish',
        'whois_create',
        'wscript_downloader_http'])


def signature_value(signature):
    '''
    Computes the value assigned for cuckoo signatures as features

    Determining the assigned value is something pending, but since the
    severity, confidence and weight of the signatures is preset as an indicator
    perhaps leaving the features as binary value (signature present or not)
    may be the best option, since otherwise no information is added.

    Arguments
    ---------------------------
    signature: dict
        Data of the signature in the JSON report of Cuckoo

    Returns
    ---------------------------
    value: numeric
        The value assigned to the signature
    '''
    '''
    return (
        signature['confidence'] * signature['weight'] * signature['severity']
    )
    '''
    return 1


def extract_cuckoo_signatures_new(json_data):
    '''
    Extracts the signatures of cuckoo as features in dictionary form.

    Not present signatures have value of zero and present have value 1
    Arguments
    ---------------------------
    json_data: dict
        Data of the JSON report of Cuckoo

    Returns
    ---------------------------
    results: dict
        Dictionary with the extracted features
    '''
    return extract_cuckoo_signatures(json_data, new_signatures())


def extract_cuckoo_signatures_current(json_data):
    '''
    Extracts the currently used signatures of cuckoo as features in dictionary
    form.

    Not present signatures have value of zero and present have value 1

    Arguments
    ---------------------------
    json_data: dict
        Data of the JSON report of Cuckoo

    Returns
    ---------------------------
    results: dict
        Dictionary with the extracted features
    '''
    return extract_cuckoo_signatures(json_data, signature_names_current())


def extract_cuckoo_signatures(json_data, signature_set):
    signature_dict = dict.fromkeys(signature_set, 0)
    for signature in json_data['signatures']:
        signature_name = signature['name']
        if signature_name in signature_dict:
            signature_dict[signature_name] = signature_value(signature)
        else:
            raise ValueError(
                    "signature name not registered: %s" % signature_name)
    return signature_dict
