# -*- coding: utf-8 -*-
"""
Created on Fri Jun 21 08:09:40 2019

@author: David
"""
from ..file_features import extract_file_features
from ..registry_features import extract_registry_features
from .cuckoo_report import FileRegistryInfo


def extract_file_registry_features(json_data):
    summary, enhanced = FileRegistryInfo().construct(json_data).run()
    json_data['behavior']['summary'] = summary
    json_data['behavior']['enhanced'] = enhanced
    file_registry_features = {}
    file_registry_features.update(extract_file_features(json_data))
    file_registry_features.update(extract_registry_features(json_data))
    return file_registry_features
