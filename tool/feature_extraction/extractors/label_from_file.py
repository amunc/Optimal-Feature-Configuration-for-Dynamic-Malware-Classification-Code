# -*- coding: utf-8 -*-
"""
Created on Thu Jul  9 10:17:34 2020

@author: David
"""
import pandas as pd
from ..processor import BaseProcessor


class LabelFromFile(BaseProcessor):
    def __init__(self, label_file, label_column, id_column):
        self.label_file = label_file
        self.label_column = label_column
        self.labels = pd.read_csv(label_file, index_col=id_column,
                                  usecols=[label_column, id_column])
        self.identifier_column = id_column

    def process(self, identifier):
        try:
            label = self.labels.loc[identifier, self.label_column]
        except KeyError:
            raise ValueError("Identifier {} not found".format(identifier))
        if label.shape:
            raise ValueError("Duplicate identifier: %s" % identifier)
        return {self.label_column: label, self.identifier_column: identifier}
